网桥bridge：在 Linux 中，能够起到虚拟交换机作用的网络设备，它是一个工作在数据
链路层（Data Link）的设备，主要功能是根据 MAC 地址学习来将数据包转发到网桥的不同端
口（Port）上。  

Docker 项目会默认在宿主机上创建一个名叫 docker0 的网桥，凡是连
接在 docker0 网桥上的容器，就可以通过它来进行通信。  

### 如何把这些容器“连接”到 docker0 网桥 ###  
需要使用**Veth Pair**的虚拟设备，
Veth Pair 设备的特点是：它被创建出来后，总是以两张虚拟网卡（Veth Peer）的形式成对出
现的。并且，从其中一个“网卡”发出的数据包，可以直接出现在与它对应的另一张“网
卡”上，哪怕这两个“网卡”在不同的 Network Namespace 里。  
 Veth Pair 常常被用作连接不同 Network Namespace 的“网线”。  
 
 实例：  
 1.启动了一个叫作 nginx-1 的容器：  
 
    $ docker run –d --name nginx-1 nginx  
 2.然后进入到这个容器中查看一下它的网络设备：  
 
    # 在宿主机上
    $ docker exec -it nginx-1 /bin/bash
    # 在容器里
    root@2b3c181aecf1:/# ifconfig
    eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST> mtu 1500
         inet 172.17.0.2 netmask 255.255.0.0 broadcast 0.0.0.0
         ...

    lo: flags=73<UP,LOOPBACK,RUNNING> mtu 65536
         inet 127.0.0.1 netmask 255.0.0.0
         ...
         
    $ route
    Kernel IP routing table
    Destination Gateway Genmask Flags Metric Ref Use Iface
    default 172.17.0.1 0.0.0.0 UG 0 0 0 eth0
    172.17.0.0 0.0.0.0 255.255.0.0 U 0 0 0 eth0  
这个容器里有一张叫作 eth0 的网卡，它正是一个 Veth Pair 设备在容器里的这一
端。  
通过 route 命令查看 nginx-1 容器的路由表，我们可以看到，这个 eth0 网卡是这个容器里的
默认路由设备；所有对 172.17.0.0/16 网段的请求，也会被交给 eth0 来处理（第二条
172.17.0.0 路由规则）。  

而这个 Veth Pair 设备的另一端，则在宿主机上。你可以通过查看宿主机的网络设备看到它  

      # 在宿主机上
      $ ifconfig
      ...
      docker0 Link encap:Ethernet HWaddr 02:42:d8:e4:df:c1 
       inet addr:172.17.0.1 Bcast:0.0.0.0 Mask:255.255.0.0
       ...
      vethb4963f3 Link encap:Ethernet HWaddr 52:81:0b:24:3d:da 
       inet6 addr: fe80::5081:bff:fe24:3dda/64 Scope:Link
       ...

      $ brctl show
      bridge name bridge id STP enabled interfaces
      docker0 8000.0242d8e4dfc1 no veth9c02e56  

通过 ifconfig 命令的输出，你可以看到，nginx-1 容器对应的 Veth Pair 设备，在宿主机上是
一张虚拟网卡。它的名字叫作 veth9c02e56。并且，通过 brctl show 的输出，你可以看到这张
网卡被“插”在了 docker0 上。   
再在这台宿主机上启动另一个 Docker 容器，比如 nginx-2,会发现一个新的、名叫 vethb4963f3 的虚拟网卡，也被“插”在了 docker0 网桥上。  
在 nginx-1 容器里 ping 一下 nginx-2 容器的 IP 地址（172.17.0.3），就会发
现同一宿主机上的两个容器**默认就是相互连通的**。   

docker网桥原理  



